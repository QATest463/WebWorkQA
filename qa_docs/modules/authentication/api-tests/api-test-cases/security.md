# Security API Test Cases â€“ Authentication

| ID             | Title                                            | Precondition                        | Steps                                                         | Expected Result                           | Actual Result | Status |
|-----------------|--------------------------------------------------|-------------------------------------|---------------------------------------------------------------|-------------------------------------------|---------------|--------|
| AU-API-SC-001   | Rate limiting on login endpoint                 | None                                | 1. Send multiple rapid POST requests to /login with invalid credentials (e.g. > limit) <br> 2. Observe response | System enforces rate limiting; returns 429 or error after threshold |               |        |
| AU-API-SC-002   | Password reset token invalid after use          | User has completed password reset   | 1. Use same token again in /password-reset/confirm <br> 2. Observe response | Response 400/401 with error about invalid/expired token |               |        |
| AU-API-SC-003   | Enforce HTTPS only                              | None                                | 1. Attempt to access endpoint over HTTP <br> 2. Observe response | Server redirects to HTTPS or rejects insecure connection |               |        |
| AU-API-SC-004   | SQL injection blocked in login payload          | None                                | 1. Send POST to /login with SQL injection strings in email/password <br> 2. Observe response | Server sanitizes input; responds with error without executing injection |               |        |
| AU-API-SC-005   | Tokens expire after inactivity                   | User has valid auth token           | 1. Log in and get auth token <br> 2. Wait beyond inactivity timeout <br> 3. Use token to access protected endpoint | Server returns 401 Unauthorized due to expired token |               |        |
| AU-API-SC-006   | Access to protected endpoint without token       | None                                | 1. Send GET to protected endpoint without auth token <br> 2. Observe response | Server returns 401 Unauthorized |               |        |
| AU-API-SC-007   | Old password invalid after reset                 | User has changed password           | 1. Complete password reset flow <br> 2. Attempt login with old password <br> 3. Observe response | Server returns 401 Unauthorized for old password |               |        |