# Security API Test Cases â€“ Billing and Payments

| ID             | Title                                              | Precondition                        | Steps                                                         | Expected Result                           | Actual Result | Status |
|-----------------|----------------------------------------------------|-------------------------------------|---------------------------------------------------------------|-------------------------------------------|---------------|--------|
| BP-API-SC-001   | Rate limiting on payment endpoint                  | None                                | 1. Send rapid multiple POST requests to /api/payments <br> 2. Observe response | System enforces rate limiting; returns 429 or error after threshold |               |        |
| BP-API-SC-002   | Enforce HTTPS-only connections                     | None                                | 1. Attempt API request over HTTP <br> 2. Observe response | Server rejects or redirects to HTTPS |               |        |
| BP-API-SC-003   | Tokenization of credit card data                   | User adds payment method            | 1. Send POST to /api/payment-methods with card details <br> 2. Observe payload and backend logs | Card data is tokenized before storage or transmission |               |        |
| BP-API-SC-004   | Duplicate payment prevention                       | User initiates payment              | 1. Send identical payment requests simultaneously <br> 2. Observe response | System detects and blocks duplicate payment attempts |               |        |
| BP-API-SC-005   | Authorization required for billing history         | User unauthenticated                | 1. Send GET to /api/billing/history without token <br> 2. Observe response | System returns 401 Unauthorized |               |        |
| BP-API-SC-006   | Access control for modifying payment methods       | User unauthenticated                | 1. Send POST/DELETE to /api/payment-methods without auth <br> 2. Observe response | System returns 401 Unauthorized |               |        |
| BP-API-SC-007   | Validation of payment request integrity            | User initiates payment              | 1. Modify payment request payload (e.g. amount) <br> 2. Send tampered request <br> 3. Observe response | Server validates and rejects tampered request with error |               |        |